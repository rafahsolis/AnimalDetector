# Label Studio Quick Reference

Quick command reference for Label Studio annotation workflow.

## Common Commands

### Initialize New Dataset

```bash
# Create dataset structure with default classes
python -m yolo.init_dataset my_dataset_name

# Create with custom classes
python -m yolo.init_dataset my_dataset_name --classes "dog,cat,mouse,bird"
```

### Start Label Studio (Docker)

```bash
# First time
docker run -it -p 8080:8080 \
    -v $(pwd)/label-studio-data:/label-studio/data \
    --name label-studio \
    heartexlabs/label-studio:latest

# Subsequent runs
docker start label-studio
docker logs -f label-studio
```

### Convert Label Studio Export to YOLO

```bash
python -m yolo.label_studio_to_yolo \
    --json /path/to/export.json \
    --images datasets/DATASET_NAME/images \
    --labels datasets/DATASET_NAME/labels \
    --classes datasets/DATASET_NAME/labels/classes.txt
```

### Validate Annotations

```bash
# Print to console
python -m yolo.validate_annotations \
    --images datasets/DATASET_NAME/images \
    --labels datasets/DATASET_NAME/labels \
    --classes datasets/DATASET_NAME/labels/classes.txt

# Save to file
python -m yolo.validate_annotations \
    --images datasets/DATASET_NAME/images \
    --labels datasets/DATASET_NAME/labels \
    --classes datasets/DATASET_NAME/labels/classes.txt \
    --output validation_report.txt
```

### Split Dataset

```bash
python -m yolo.split_dataset --dataset DATASET_NAME
```

### Generate data.yaml

```bash
python -m yolo.generate_data_yaml --dataset DATASET_NAME
```

### Train Model

```bash
python -m yolo.train_model
```

## Complete Workflow Example

```bash
# 1. Initialize dataset
python -m yolo.init_dataset fototrampeo_bosque

# 2. Copy images
cp /source/images/* datasets/fototrampeo_bosque/images/

# 3. Start Label Studio
docker start label-studio
# Open http://localhost:8080

# 4. Annotate in Label Studio UI
# (Create project, import images, draw boxes, submit)

# 5. Export from Label Studio
# Download JSON format → export.json

# 6. Convert to YOLO
python -m yolo.label_studio_to_yolo \
    --json export.json \
    --images datasets/fototrampeo_bosque/images \
    --labels datasets/fototrampeo_bosque/labels \
    --classes datasets/fototrampeo_bosque/labels/classes.txt

# 7. Validate
python -m yolo.validate_annotations \
    --images datasets/fototrampeo_bosque/images \
    --labels datasets/fototrampeo_bosque/labels \
    --classes datasets/fototrampeo_bosque/labels/classes.txt

# 8. Split dataset
python -m yolo.split_dataset --dataset fototrampeo_bosque

# 9. Generate config
python -m yolo.generate_data_yaml --dataset fototrampeo_bosque

# 10. Train
python -m yolo.train_model
```

## File Locations

```
datasets/DATASET_NAME/
├── images/              # Put original images here
├── labels/              # Converted YOLO labels go here
│   └── classes.txt      # Edit class names here
├── train/               # Auto-generated by split
├── val/                 # Auto-generated by split
├── test/                # Auto-generated by split
├── data.yaml            # Auto-generated config
└── README.md            # Dataset documentation
```

## Label Studio Docker Commands

```bash
# Start
docker start label-studio

# Stop
docker stop label-studio

# View logs
docker logs -f label-studio

# Remove container
docker rm label-studio

# Remove and recreate
docker rm label-studio
docker run -it -p 8080:8080 \
    -v $(pwd)/label-studio-data:/label-studio/data \
    --name label-studio \
    heartexlabs/label-studio:latest
```

## Troubleshooting

### Can't find images after export

```bash
# Check filenames match
ls datasets/DATASET_NAME/images/ | head
# vs JSON export image paths

# Try with absolute paths
python -m yolo.label_studio_to_yolo \
    --json export.json \
    --images $(pwd)/datasets/DATASET_NAME/images \
    --labels $(pwd)/datasets/DATASET_NAME/labels \
    --classes $(pwd)/datasets/DATASET_NAME/labels/classes.txt
```

### Label Studio won't start

```bash
# Check if port 8080 is in use
lsof -i :8080

# Use different port
docker run -it -p 8081:8080 \
    -v $(pwd)/label-studio-data:/label-studio/data \
    heartexlabs/label-studio:latest
```

### Class names don't match

```bash
# View current classes
cat datasets/DATASET_NAME/labels/classes.txt

# Edit classes
nano datasets/DATASET_NAME/labels/classes.txt
# or
code datasets/DATASET_NAME/labels/classes.txt
```

## Advanced Usage

### Incremental Annotation

```bash
# Export only new annotations from Label Studio
# (filter by date in export dialog)

# Convert with existing labels (won't overwrite)
python -m yolo.label_studio_to_yolo \
    --json new_batch.json \
    --images datasets/DATASET_NAME/images \
    --labels datasets/DATASET_NAME/labels \
    --classes datasets/DATASET_NAME/labels/classes.txt
```

### Multiple Datasets

```bash
# Initialize multiple datasets
python -m yolo.init_dataset camera_1
python -m yolo.init_dataset camera_2
python -m yolo.init_dataset camera_3

# Process each separately
for dataset in camera_1 camera_2 camera_3; do
    python -m yolo.label_studio_to_yolo \
        --json ${dataset}_export.json \
        --images datasets/${dataset}/images \
        --labels datasets/${dataset}/labels \
        --classes datasets/${dataset}/labels/classes.txt
done
```

### Backup

```bash
# Backup annotations
tar -czf annotations_backup_$(date +%Y%m%d).tar.gz \
    datasets/*/labels/*.txt \
    datasets/*/labels/classes.txt

# Backup Label Studio data
tar -czf labelstudio_backup_$(date +%Y%m%d).tar.gz \
    label-studio-data/
```

## Keyboard Shortcuts (Label Studio)

- `Ctrl + Enter` - Submit and next
- `Ctrl + Backspace` - Skip task  
- `Delete` - Delete selected box
- `Ctrl + Z` - Undo
- `Ctrl + Shift + Z` - Redo
- `1-8` - Select class label
- `Space` - Pan mode
- `Ctrl + Mouse Wheel` - Zoom

## See Also

- [Complete Guide](LABEL_STUDIO_GUIDE.md)
- [Training Guide](TRAINING_GUIDE.md)
- [FAQ](TRAINING_FAQ.md)

